---
slug: sdk/stack-app
---

This is a detailed reference for the `StackApp` object. [Here](../concepts/stack-app.mdx) is a more high-level overview.

## Different types of stack apps

Stack offers two types of app objects: `StackClientApp` and `StackServerApp`.

1. `StackClientApp`:
   - Designed for client-side applications
   - Provides functionality like `signInWithOAuth`, `useUser`, `useProject`, etc.
   - Obtain it by calling `useStackApp()` in a Client Component

2. `StackServerApp`:
   - extends `StackClientApp`
   - Has additional capabilities like being able to listing all the users in the project
   - Access it by importing the object from the file where you created it (`import { stackServerApp } from '@/stack'`)

Choose the appropriate type based on your application's needs and environment.


## `StackClientApp`

You can get a `StackClientApp` instance by calling `useStackApp()` in a Client Component.

### Initialization

In most cases, we don't create a `StackClientApp` directly. Instead, we typically:

1. Create a `StackServerApp` instance, pass it into the `StackProvider` component
2. Use the `useStackApp()` hook to obtain a `StackClientApp` from it

Check out the manual [setup guide](../getting-started/setup.mdx) for more details. For details on how to initialize a `StackServerApp`, refer to the [StackServerApp section](#stackserverapp) below.

### Properties

<div className="indented">
<ParamField path="projectId" type="string">
The ID of the project that the app is associated with.
</ParamField>

<ParamField path="urls" type="object">
  The URLs that Stack uses to route and redirect.

  <div className="indented">
  <ParamField path="home" type="string">
  The URL of the home page.
  </ParamField>
  <ParamField path="signIn" type="string">
  The URL of the sign-in page.
  </ParamField>
  <ParamField path="afterSignIn" type="string">
  The URL that the user will be redirected to after successful signing in.
  </ParamField>
  <ParamField path="signUp" type="string">
  The URL of the sign-up page.
  </ParamField>
  <ParamField path="afterSignUp" type="string">
  The URL that the user will be redirected to after successful signing up.
  </ParamField>
  <ParamField path="afterSignOut" type="string">
  The URL that the user will be redirected to after successful signing out.
  </ParamField>
  <ParamField path="emailVerification" type="string">
  The URL of the email verification page.
  </ParamField>
  <ParamField path="passwordReset" type="string">
  The URL of the password reset page.
  </ParamField>
  <ParamField path="forgotPassword" type="string">
  The URL of the forgot password page.
  </ParamField>
  <ParamField path="accountSettings" type="string">
  The URL of the account settings page.
  </ParamField>
  <ParamField path="handler" type="string">
  The URL of the handler root. 
  </ParamField>
  </div>
</ParamField>
</div>

### `getUser()`

Get the current user.

**Parameters:**

<div className="indented">
<ParamField path="options" type="object">
  <div className="indented">
  <ParamField path="or" type="string" required>
  What to do if the user is not signed in. Can be:
  - `"redirect"`: Redirects the user to the `signIn` URL.
  - `"throw"`: Throws an error.
  </ParamField>
  </div>
</ParamField>
</div>

**Returns:**

<div className="indented">
- If `or` is not provided, returns `Promise<CurrentUser | null>`.
- If `or` is `"redirect"` or `"throw"`, always returns `Promise<CurrentUser>`.
</div>

**Example:**

```typescript
const user = await stackClientApp.getUser({ or: "redirect" });
console.log(user); // always defined

const user = await stackClientApp.getUser();
console.log(user); // null if not signed in
```

### `useUser()`

Get the current user.

This is the same as `getUser()` but it is a React hook. The `useUser` hook imported from the package is an alias for this function.

**Parameters:**

<div className="indented">
<ParamField path="options" type="object">
  <div className="indented">
  <ParamField path="or" type="string" required>
  What to do if the user is not signed in. Can be:
  - `"redirect"`: Redirects the user to the `signIn` URL.
  - `"throw"`: Throws an error.
  </ParamField>
  </div>
</ParamField>
</div>

**Returns:**

<div className="indented">
- If `or` is not provided, returns `CurrentUser | null`.
- If `or` is `"redirect"` or `"throw"`, always returns `CurrentUser`.
</div>

**Example:**

```typescript
const user = useUser({ or: "redirect" });
console.log(user); // always defined

const user = useUser();
console.log(user); // null if not signed in
```

### `signInWithOAuth()`

Initiates the OAuth sign-in process with the specified provider. This method:

1. Redirects the user to the OAuth provider's sign-in page.
2. After successful authentication, redirects the user back to your application.
3. The final redirect destination is determined as follows:
   - If an `after_auth_return_to` query parameter was provided when calling this function, it uses that URL.
   - Otherwise, it uses the `afterSignIn` URL configured in the app settings.

**Parameters:**

<div className="indented">
<ParamField path="provider" type="string" required>
The type of the OAuth provider to sign in with.
</ParamField>
</div>

**Returns:**

<div className="indented">
`Promise<void>`: A promise that resolves when the redirect is complete.
</div>

**Example:**

```typescript
await stackClientApp.signInWithOAuth("google");
```

### `signInWithCredential()`
 
Sign in using email and password credentials. The behavior is as follows:

1. If sign-in is successful:
   - By default, redirects the user to the `afterSignIn` URL.
   - If `after_auth_return_to` is provided in the query parameters, redirects to that URL instead.
   - If `noRedirect` is set to `true`, it will not redirect and instead return a success `Result` object.

2. If sign-in fails:
   - No redirection occurs.
   - Returns a `Result` object containing error information.

**Parameters:**

<div className="indented">
<ParamField path="options" type="object">
  <div className="indented">
  <ParamField path="email" type="string" required>
  The email of the user to sign in with.
  </ParamField>
  <ParamField path="password" type="string" required>
  The password of the user to sign in with.
  </ParamField>
  <ParamField path="noRedirect" type="boolean">
  Whether to not redirect the user after sign-in. Defaults to `false`.
  </ParamField>
  </div>
</ParamField>
</div>

**Returns:**

<div className="indented">
`Promise<Result<undefined, KnownErrors["EmailPasswordMismatch"]>>`: A promise that resolves to a `Result` object.
</div>

**Example:**

```typescript
const result = await stackClientApp.signInWithCredential({
  email: "test@example.com",
  password: "password",
});

if (result.status === "error") {
  console.error("Sign in failed", result.error.message);
}
```

### `signUpWithCredential()`

Sign up using email and password credentials. The behavior is as follows:

1. If sign-up is successful:
   - By default, redirects the user to the `afterSignUp` URL.
   - If `after_auth_return_to` is provided in the query parameters, redirects to that URL instead.
   - If `noRedirect` is set to `true`, it will not redirect and instead return a success `Result` object.

2. If sign-up fails:
   - No redirection occurs.
   - Returns a `Result` object containing error information.

**Parameters:**

<div className="indented">
<ParamField path="options" type="object">
  <div className="indented">
  <ParamField path="email" type="string" required>
  The email of the user to sign up with.
  </ParamField>
  <ParamField path="password" type="string" required>
  The password of the user to sign up with.
  </ParamField>
  <ParamField path="noRedirect" type="boolean">
  Whether to not redirect the user after sign-up. Defaults to `false`.
  </ParamField>
  </div>
</ParamField>
</div>

**Returns:**

<div className="indented">
`Promise<Result<undefined, KnownErrors["UserEmailAlreadyExists"] | KnownErrors["PasswordRequirementsNotMet"]>>`: A promise that resolves to a `Result` object.
</div>

**Example:**

```typescript
const result = await stackClientApp.signUpWithCredential({
  email: "test@example.com",
  password: "password",
});

if (result.status === "error") {
  console.error("Sign up failed", result.error.message);
}
```

### `sendForgotPasswordEmail()`

Send a forgot password email to an email address.

**Parameters:**

<div className="indented">
<ParamField path="email" type="string" required>
The email of the user to send the forgot password email to.
</ParamField>
</div>

**Returns:**

<div className="indented">
`Promise<Result<undefined, KnownErrors["UserNotFound"]>>`: A promise that resolves to a `Result` object.
</div>

**Example:**

```typescript
const result = await stackClientApp.sendForgotPasswordEmail("test@example.com");

if (result.status === "success") {
  console.log("Forgot password email sent");
} else {
  console.error("Failed to send forgot password email", result.error.message);
}
```

### `sendMagicLinkEmail()`

Send a magic link/OTP sign-in email to an email address.

**Parameters:**

<div className="indented">
<ParamField path="email" type="string" required>
The email of the user to send the magic link email to.
</ParamField>
</div>

**Returns:**

<div className="indented">
`Promise<Result<{ nonce: string }, KnownErrors["RedirectUrlNotWhitelisted"]>>`: A promise that resolves to a `Result` object.
</div>

**Example:**

```typescript
const result = await stackClientApp.sendMagicLinkEmail("test@example.com");
```

## `StackServerApp`

`StackServerApp` extends `StackClientApp`, so it has all the same capabilities, plus some extra ones listed below.

### Initialization

**Parameters:**

<div className="indented">
<ParamField path="options" type="object">
  <div className="indented">
  <ParamField path="tokenStore" type="string" required>
  Where to store the auth tokens. Currently only `"nextjs-cookie"` is supported.
  </ParamField>

  <ParamField path="oauthScopesOnSignIn" type="object">
  Extra OAuth scopes to request when signing in. It is an object of format `{ [provider: string]: string[] }`, where the key is the provider type (e.g. `"google"`, `"apple"`, etc.) and the value is an array of scopes to request. Checkout the [OAuth](../concepts/oauth.mdx) page for more details.
  </ParamField>

  <ParamField path="baseUrl" type="string">
  The base URL of the Stack server. By default it is read from the `NEXT_PUBLIC_STACK_URL` environment variable if it exists, or use `https://api.stack-auth.com` if it doesn't.
  </ParamField>

  <ParamField path="projectId" type="string">
  The ID of the project to use. By default it is read from the `NEXT_PUBLIC_STACK_PROJECT_ID` environment variable.
  </ParamField>

  <ParamField path="publishableClientKey" type="string">
  The publishable client key to use. By default it is read from the `NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY` environment variable.
  </ParamField>

  <ParamField path="secretServerKey" type="string">
  The secret server key to use. By default it is read from the `STACK_SECRET_SERVER_KEY` environment variable.
  </ParamField>

  <ParamField path="urls" type="object">
    Modify the URLs that Stack uses to route and redirect.
    <div className="indented">
      <ParamField path="home" type="string" default="'/'" >
      The URL of the home page.
      </ParamField>
      <ParamField path="signIn" type="string" default="urls.handler + '/sign-in'">
      The URL of the sign-in page.
      </ParamField>
      <ParamField path="afterSignIn" type="string" default="urls.home">
      The URL that the user will be redirected to after successful signing in.
      </ParamField>
      <ParamField path="signUp" type="string" default="urls.handler + '/sign-up'">
      The URL of the sign-up page.
      </ParamField>
      <ParamField path="afterSignUp" type="string" default="urls.home">
      The URL that the user will be redirected to after successful signing up.
      </ParamField>
      <ParamField path="afterSignOut" type="string" default="urls.home">
      The URL that the user will be redirected to after successful signing out.
      </ParamField>
      <ParamField path="emailVerification" type="string" default="urls.handler + '/email-verification'">
      The URL of the email verification page.
      </ParamField>
      <ParamField path="passwordReset" type="string" default="urls.handler + '/password-reset'">
      The URL of the password reset page.
      </ParamField>
      <ParamField path="forgotPassword" type="string" default="urls.handler + '/forgot-password'">
      The URL of the forgot password page.
      </ParamField>
      <ParamField path="accountSettings" type="string" default="urls.handler + '/account-settings'">
      The URL of the account settings page.
      </ParamField>
      <ParamField path="handler" type="string" default="'/handler'">
      The URL of the handler root. When changing this, you should also change the location of the `StackHandler` component and the domain handler path on the dashboard. Currently putting the handler at the root `/` is not supported.
      </ParamField>
    </div>
  </ParamField>
  </div>

</ParamField>
</div>

**Example:**

```typescript
const stackServerApp = new StackServerApp({
  tokenStore: "nextjs-cookie",
  oauthScopesOnSignIn: {
    google: ["extra-scope"],
  },
  urls: {
    signIn: '/my-custom-sign-in-page',
  },
});
```
